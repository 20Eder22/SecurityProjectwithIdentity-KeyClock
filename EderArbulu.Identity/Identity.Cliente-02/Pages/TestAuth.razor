@page "/test-auth"
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager Nav

<h3>🔍 Test de Autenticación</h3>

<button class="btn btn-primary mt-3" @onclick="Check">Verificar Estado</button>
<button class="btn btn-danger mt-3" @onclick="GoHome"> Regresar</button>

@if (msg != null)
{
    <pre>@msg</pre>
}

@code {
    private string? msg;

    private async Task Check()
    {
        var state = await AuthStateProvider.GetAuthenticationStateAsync();
        var user = state.User;

        var claimsString = string.Join("\n", user.Claims.Select(c => $"{c.Type}: {c.Value}"));

        msg =
            "Identity.IsAuthenticated: " + user.Identity?.IsAuthenticated + "\n" +
            "Name: " + (user.Identity?.Name ?? "(null)") + "\n" +
            "Claims:\n" + claimsString;
    }

    private void GoHome()
    {
        Nav.NavigateTo("/", true);
    }
}